[gd_scene load_steps=29 format=3 uid="uid://dsdafmm8uboj3"]

[ext_resource type="PackedScene" uid="uid://hwjqp78r3gpa" path="res://assets/levels/models/room_main.tscn" id="1_xlv32"]
[ext_resource type="Environment" uid="uid://dgn7yadiyci1m" path="res://levels/environment_0.tres" id="2_bbvwo"]
[ext_resource type="PackedScene" uid="uid://bh3rdb37xulek" path="res://assets/levels/models/RoomSoftDarkness.glb" id="2_dsdcb"]
[ext_resource type="PackedScene" uid="uid://lbyfu5tppd00" path="res://characters/player/player.tscn" id="3_xlv32"]
[ext_resource type="Script" uid="uid://bkhvmkrwodyya" path="res://objects/ritual_area.gd" id="4_dt74c"]
[ext_resource type="PackedScene" uid="uid://cedotbanlwp23" path="res://objects/combination_creator.tscn" id="5_wn8mm"]
[ext_resource type="PackedScene" uid="uid://blha2pgibs2lf" path="res://UI/qte_game.tscn" id="6_dsdcb"]
[ext_resource type="PackedScene" uid="uid://b0dqmv5mn3a8u" path="res://objects/demon_summoner.tscn" id="7_c2lvv"]
[ext_resource type="Script" uid="uid://bp6w7frh5jdyk" path="res://objects/ritual.gd" id="7_wn8mm"]
[ext_resource type="PackedScene" uid="uid://tr2gnn5ud7dr" path="res://global/trigger.tscn" id="9_5c206"]
[ext_resource type="PackedScene" uid="uid://cbpnv5nyhewgk" path="res://objects/props/monolith_big.tscn" id="12_m0lr2"]
[ext_resource type="PackedScene" uid="uid://coa4iy4bj0e7w" path="res://objects/props/tombstone.tscn" id="13_mqd01"]
[ext_resource type="PackedScene" uid="uid://dcg01n3ptg7j3" path="res://characters/sectarian/Sectarian.tscn" id="13_mwfpk"]
[ext_resource type="PackedScene" uid="uid://bojjurpos15hr" path="res://objects/props/candles_1.tscn" id="14_i0ixq"]
[ext_resource type="Script" uid="uid://biwywciupq37h" path="res://objects/sectarians.gd" id="14_mwfpk"]
[ext_resource type="PackedScene" uid="uid://b75plme3dod2o" path="res://objects/props/chandelier_floor.tscn" id="17_apy0m"]
[ext_resource type="PackedScene" uid="uid://ctpecr3l5jl6o" path="res://objects/props/tombstones_row.tscn" id="18_f07vl"]
[ext_resource type="PackedScene" uid="uid://c5gby5giqb6oo" path="res://objects/props/candle_1.tscn" id="18_m0lr2"]
[ext_resource type="PackedScene" uid="uid://dpiyc15rkawy5" path="res://objects/props/candles_no_light.tscn" id="18_m2tq3"]
[ext_resource type="PackedScene" uid="uid://thgbjmlcutvd" path="res://objects/props/chalice.tscn" id="19_mqd01"]
[ext_resource type="PackedScene" uid="uid://baqei342ipmx3" path="res://objects/props/candle_no_light.tscn" id="19_qf884"]
[ext_resource type="PackedScene" uid="uid://vj342yewfp8e" path="res://objects/props/chandelier_ceiling.tscn" id="20_m2tq3"]
[ext_resource type="AudioStream" uid="uid://m0pf7x1u5swf" path="res://assets/Audio/music/MUSIC_ambient.mp3" id="20_mqd01"]
[ext_resource type="PackedScene" uid="uid://ckd7xdfsjy1ki" path="res://assets/levels/models/Pentagram.glb" id="21_m2tq3"]

[sub_resource type="CylinderShape3D" id="CylinderShape3D_dt74c"]
radius = 1.1

[sub_resource type="CylinderMesh" id="CylinderMesh_dt74c"]
top_radius = 1.1
bottom_radius = 1.1

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_wn8mm"]
transparency = 4
albedo_color = Color(1, 0.43333334, 0, 0.23921569)

[sub_resource type="GDScript" id="GDScript_wn8mm"]
script/source = "extends Label3D



func _ready() -> void:
	text = ''

func _on_ritual_action_maked(act: String) -> void:
	text = act
func _on_ritual_ended() -> void:
	text = ''
"

[node name="MainRoom" type="Node3D"]

[node name="RoomMain" parent="." instance=ExtResource("1_xlv32")]

[node name="RoomSoftDarkness" parent="RoomMain" instance=ExtResource("2_dsdcb")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.0039691925, 0.021327019, -0.028426409)

[node name="OmniLight3D" type="OmniLight3D" parent="RoomMain"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.9971597, 0)
light_color = Color(1, 0.7276667, 0.57, 1)
light_energy = 15.492
light_size = 1.0
light_specular = 0.0
light_bake_mode = 1
shadow_enabled = true
shadow_opacity = 0.67
shadow_blur = 1.8
omni_range = 4096.0

[node name="WorldEnvironment" type="WorldEnvironment" parent="RoomMain"]
environment = ExtResource("2_bbvwo")

[node name="Player" parent="." instance=ExtResource("3_xlv32")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 12.506918, 9.1106534e-07, 19.446947)

[node name="RitualArea" type="Node3D" parent="."]
script = ExtResource("4_dt74c")

[node name="CombinationCreator" parent="RitualArea" instance=ExtResource("5_wn8mm")]

[node name="Ritual" type="Node" parent="RitualArea"]
script = ExtResource("7_wn8mm")

[node name="ActionRestTimer" type="Timer" parent="RitualArea/Ritual"]
process_callback = 0
wait_time = 5.0
one_shot = true

[node name="QTEGame" parent="RitualArea" node_paths=PackedStringArray("player") instance=ExtResource("6_dsdcb")]
player = NodePath("../../Player")

[node name="DemonSummoner" parent="RitualArea" instance=ExtResource("7_c2lvv")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.760057)

[node name="Trigger" parent="RitualArea" instance=ExtResource("9_5c206")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 3.2672462)

[node name="PlayerPosition" type="Marker3D" parent="RitualArea/Trigger"]
transform = Transform3D(1, 0, 0, 0, 0.99050945, 0.13744454, 0, -0.13744454, 0.99050945, 0, -1, 0)
gizmo_extents = 1.0

[node name="CollisionShape3D" type="CollisionShape3D" parent="RitualArea/Trigger"]
shape = SubResource("CylinderShape3D_dt74c")

[node name="DebugTriggerShape" type="MeshInstance3D" parent="RitualArea/Trigger"]
visible = false
mesh = SubResource("CylinderMesh_dt74c")
surface_material_override/0 = SubResource("StandardMaterial3D_wn8mm")

[node name="Label" type="Label3D" parent="RitualArea/Trigger/DebugTriggerShape"]
pixel_size = 0.0025
billboard = 1
text = "Встань сюда"
font_size = 48

[node name="ActionLabel" type="Label3D" parent="RitualArea"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.5687656, 0)
billboard = 1
script = SubResource("GDScript_wn8mm")

[node name="Props" type="Node3D" parent="."]

[node name="MonolithBig" parent="Props" instance=ExtResource("12_m0lr2")]
transform = Transform3D(-0.88, 0, -1.5448886e-05, 0, 0.88, 0, 1.5448886e-05, 0, -0.88, -16.402267, 2.407422, 0)

[node name="Tombstone3" parent="Props" instance=ExtResource("13_mqd01")]
transform = Transform3D(-1, 0, 8.742278e-08, 0, 1, 0, -8.742278e-08, 0, -1, -14.997926, 1.9999995, -5.216383)

[node name="Tombstone4" parent="Props" instance=ExtResource("13_mqd01")]
transform = Transform3D(-1, 0, 8.742278e-08, 0, 1, 0, -8.742278e-08, 0, -1, -14.998321, 2, 5.216)

[node name="Candles1" parent="Props" instance=ExtResource("14_i0ixq")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.6890948, 2.3841858e-07, 1.6912436)

[node name="Candles2" parent="Props" instance=ExtResource("14_i0ixq")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.3713182, 0, -2.0251856)

[node name="СhandelierFloor" parent="Props" instance=ExtResource("17_apy0m")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10.578, 2, 4.095)

[node name="СhandelierFloor2" parent="Props" instance=ExtResource("17_apy0m")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10.5294485, 2, -4.050331)

[node name="СhandelierFloor3" parent="Props" instance=ExtResource("17_apy0m")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -17.223047, 2.0028396, 5.0070906)

[node name="СhandelierFloor4" parent="Props" instance=ExtResource("17_apy0m")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -17.34057, 2.0028389, -4.1528835)

[node name="СhandelierFloor5" parent="Props" instance=ExtResource("17_apy0m")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10.569656, 2.0028396, -10.87128)

[node name="СhandelierFloor6" parent="Props" instance=ExtResource("17_apy0m")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10.656411, 2.002839, 10.924914)

[node name="СhandelierFloor7" parent="Props" instance=ExtResource("17_apy0m")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -2.5139747, 0.0028392076, -11.055027)

[node name="СhandelierFloor8" parent="Props" instance=ExtResource("17_apy0m")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -2.4702501, 0.0028389692, 10.703416)

[node name="СhandelierFloor11" parent="Props" instance=ExtResource("17_apy0m")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 3.672884, 0.0028392076, -12.3664255)

[node name="СhandelierFloor12" parent="Props" instance=ExtResource("17_apy0m")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 3.7166085, 0.0028389692, 12.323989)

[node name="Candle1" parent="Props" instance=ExtResource("18_m0lr2")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.9660845, -2.3841858e-07, 1.4118361)

[node name="Candle2" parent="Props" instance=ExtResource("18_m0lr2")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -2.1841917, -2.3841858e-07, -0.495466)

[node name="Candle3" parent="Props" instance=ExtResource("18_m0lr2")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2.2556162, 0, -0.3766644)

[node name="Chalice" parent="Props" instance=ExtResource("19_mqd01")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -7.119, 2.2, 0)

[node name="СhandelierFloor9" parent="Props" instance=ExtResource("17_apy0m")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -6.5654984, 0.0028396845, 2.4744802)

[node name="СhandelierFloor10" parent="Props" instance=ExtResource("17_apy0m")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -6.3908124, 0.0028392076, -2.2915313)

[node name="Tombstones" type="Node3D" parent="Props"]

[node name="TombstonesRow1" parent="Props/Tombstones" instance=ExtResource("18_f07vl")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 14, 0, 6)

[node name="TombstonesRow2" parent="Props/Tombstones" instance=ExtResource("18_f07vl")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 14, 0, -6)

[node name="TombstonesRow3" parent="Props/Tombstones" instance=ExtResource("18_f07vl")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 18, 0, 6)

[node name="TombstonesRow4" parent="Props/Tombstones" instance=ExtResource("18_f07vl")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 18, 0, -6)

[node name="TombstonesRow5" parent="Props/Tombstones" instance=ExtResource("18_f07vl")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 22, 0, 6)

[node name="TombstonesRow6" parent="Props/Tombstones" instance=ExtResource("18_f07vl")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 22, 0, -6)

[node name="TombstonesRow7" parent="Props/Tombstones" instance=ExtResource("18_f07vl")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 27, 0, 6)

[node name="TombstonesRow8" parent="Props/Tombstones" instance=ExtResource("18_f07vl")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 27, 0, -6)

[node name="TombstonesRow9" parent="Props/Tombstones" instance=ExtResource("18_f07vl")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 33, 0, 6)

[node name="TombstonesRow10" parent="Props/Tombstones" instance=ExtResource("18_f07vl")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 33, 0, -6)

[node name="AltarCandles" type="Node3D" parent="Props"]

[node name="Candles3" parent="Props/AltarCandles" instance=ExtResource("18_m2tq3")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -6.6741056, 2.2000003, 1.0478706)

[node name="Candles4" parent="Props/AltarCandles" instance=ExtResource("18_m2tq3")]
transform = Transform3D(0.2105571, 0, 0.97758156, 0, 1, 0, -0.97758156, 0, 0.2105571, -6.6741056, 2.2000003, -0.8856671)

[node name="Candle4" parent="Props/AltarCandles" instance=ExtResource("19_qf884")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -6.9960394, 2.2, 1.8159952)

[node name="Candle5" parent="Props/AltarCandles" instance=ExtResource("19_qf884")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -7.5619154, 2.2, 2.54055)

[node name="Candle6" parent="Props/AltarCandles" instance=ExtResource("19_qf884")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -8.415737, 2.2, 3.1596882)

[node name="Candle7" parent="Props/AltarCandles" instance=ExtResource("19_qf884")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -6.9142885, 2.2, -1.7520022)

[node name="Candle8" parent="Props/AltarCandles" instance=ExtResource("19_qf884")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -7.3427105, 2.2000005, -2.458389)

[node name="Candle9" parent="Props/AltarCandles" instance=ExtResource("19_qf884")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -8.116741, 2.1999998, -3.040957)

[node name="Ceiling" type="Node3D" parent="Props"]

[node name="СhandelierCeiling" parent="Props/Ceiling" instance=ExtResource("20_m2tq3")]
transform = Transform3D(1.36, 0, 0, 0, 1.36, 0, 0, 0, 1.36, -3, 9, -6)

[node name="СhandelierCeiling2" parent="Props/Ceiling" instance=ExtResource("20_m2tq3")]
transform = Transform3D(1.36, 0, 0, 0, 1.36, 0, 0, 0, 1.36, 6, 9, -6)

[node name="СhandelierCeiling3" parent="Props/Ceiling" instance=ExtResource("20_m2tq3")]
transform = Transform3D(1.36, 0, 0, 0, 1.36, 0, 0, 0, 1.36, 14, 9, -6)

[node name="СhandelierCeiling4" parent="Props/Ceiling" instance=ExtResource("20_m2tq3")]
transform = Transform3D(1.36, 0, 0, 0, 1.36, 0, 0, 0, 1.36, 23, 9, -6)

[node name="СhandelierCeiling5" parent="Props/Ceiling" instance=ExtResource("20_m2tq3")]
transform = Transform3D(1.36, 0, 0, 0, 1.36, 0, 0, 0, 1.36, -3, 9, 6)

[node name="СhandelierCeiling6" parent="Props/Ceiling" instance=ExtResource("20_m2tq3")]
transform = Transform3D(1.36, 0, 0, 0, 1.36, 0, 0, 0, 1.36, 6, 9, 6)

[node name="СhandelierCeiling7" parent="Props/Ceiling" instance=ExtResource("20_m2tq3")]
transform = Transform3D(1.36, 0, 0, 0, 1.36, 0, 0, 0, 1.36, 14, 9, 6)

[node name="СhandelierCeiling8" parent="Props/Ceiling" instance=ExtResource("20_m2tq3")]
transform = Transform3D(1.36, 0, 0, 0, 1.36, 0, 0, 0, 1.36, 23, 9, 6)

[node name="Sectarians" type="Node3D" parent="."]
script = ExtResource("14_mwfpk")

[node name="Sectarian" parent="Sectarians" instance=ExtResource("13_mwfpk")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -3.4038577)

[node name="Sectarian2" parent="Sectarians" instance=ExtResource("13_mwfpk")]
transform = Transform3D(0.9053614, 0, -0.42464194, 0, 1, 0, 0.42464194, 0, 0.9053614, 1.5418051, 0, -2.7383287)

[node name="Sectarian3" parent="Sectarians" instance=ExtResource("13_mwfpk")]
transform = Transform3D(0.47367328, 0, -0.8807007, 0, 1, 0, 0.8807007, 0, 0.47367328, 2.6254048, 2.3841858e-07, -1.4867542)

[node name="Sectarian4" parent="Sectarians" instance=ExtResource("13_mwfpk")]
transform = Transform3D(-0.06918193, 0, -0.99760413, 0, 1, 0, 0.99760413, 0, -0.06918193, 3.213358, 0, -0.088382006)

[node name="Sectarian5" parent="Sectarians" instance=ExtResource("13_mwfpk")]
transform = Transform3D(-0.58283234, 0, -0.81259245, 0, 1, 0, 0.81259245, 0, -0.58283234, 2.7661064, 2.3841858e-07, 1.3302068)

[node name="Sectarian6" parent="Sectarians" instance=ExtResource("13_mwfpk")]
transform = Transform3D(-0.91728264, 0, -0.39823678, 0, 1, 0, 0.39823678, 0, -0.91728264, 1.95055, 2.3841858e-07, 2.6466649)

[node name="Sectarian7" parent="Sectarians" instance=ExtResource("13_mwfpk")]
transform = Transform3D(-0.91189826, 0, 0.41041657, 0, 1, 0, -0.41041657, 0, -0.91189826, -2.0509045, 0, 2.853975)

[node name="Sectarian8" parent="Sectarians" instance=ExtResource("13_mwfpk")]
transform = Transform3D(-0.41943622, 0, 0.907785, 0, 1, 0, -0.907785, 0, -0.41943622, -3.0989168, 0, 1.4607284)

[node name="Sectarian9" parent="Sectarians" instance=ExtResource("13_mwfpk")]
transform = Transform3D(-0.059985727, 0, 0.9981994, 0, 1, 0, -0.9981994, 0, -0.059985727, -3.3260956, 0, -0.26623476)

[node name="Sectarian10" parent="Sectarians" instance=ExtResource("13_mwfpk")]
transform = Transform3D(0.49860895, 0, 0.8668272, 0, 1, 0, -0.8668272, 0, 0.49860895, -2.9269767, 2.3841858e-07, -1.9731631)

[node name="Sectarian11" parent="Sectarians" instance=ExtResource("13_mwfpk")]
transform = Transform3D(0.92921656, 0, 0.36953586, 0, 1, 0, -0.36953586, 0, 0.92921656, -1.7181884, 2.3841858e-07, -3.2165768)

[node name="Music" type="AudioStreamPlayer" parent="."]
stream = ExtResource("20_mqd01")
pitch_scale = 0.74
autoplay = true
parameters/looping = false

[node name="Pentagram2" parent="." instance=ExtResource("21_m2tq3")]
transform = Transform3D(2, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0.011, 0)

[connection signal="action_maked" from="RitualArea/Ritual" to="RitualArea/QTEGame" method="_on_ritual_action_maked"]
[connection signal="action_maked" from="RitualArea/Ritual" to="RitualArea/ActionLabel" method="_on_ritual_action_maked"]
[connection signal="action_maked" from="RitualArea/Ritual" to="Sectarians" method="_on_ritual_action_maked"]
[connection signal="ended" from="RitualArea/Ritual" to="RitualArea/QTEGame" method="_on_ritual_ended"]
[connection signal="ended" from="RitualArea/Ritual" to="RitualArea/ActionLabel" method="_on_ritual_ended"]
[connection signal="ended" from="RitualArea/Ritual" to="Sectarians" method="_on_ritual_ended"]
[connection signal="started" from="RitualArea/Ritual" to="RitualArea/QTEGame" method="_on_ritual_started"]
[connection signal="summoned" from="RitualArea/DemonSummoner" to="RitualArea" method="_on_demon_summoner_summoned"]
[connection signal="player_entered" from="RitualArea/Trigger" to="RitualArea" method="_on_trigger_player_entered" flags=6]
